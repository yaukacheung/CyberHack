# Chapter 3: Web Exploitation

## 3.1 Understanding the Web
The web is the most common attack surface. To exploit it, you must understand how it works.

### HTTP/S Protocol
*   **Request/Response Cycle:** Client sends a request, Server processes it and sends a response.
*   **Methods:**
    *   `GET`: Retrieve data. Data is visible in URL parameters.
    *   `POST`: Submit data. Data is in the body, not visible in URL.
    *   `PUT`/`DELETE`: Modify resources.
*   **Headers:**
    *   `Cookies`: Maintain state (login sessions) since HTTP is stateless.
    *   `User-Agent`: Identifies the client software.

## 3.2 SQL Injection (SQLi)
The most devastating web vulnerability. It allows an attacker to interfere with the queries an application makes to its database.

<!-- Placeholder: [Image: sqli_diagram.png] - Visualizing how malicious input alters the SQL query structure -->

### Types of SQLi
1.  **Union-Based:** Uses the `UNION` operator to combine the results of the original query with the results of an injected query. The results are visible on the page.
2.  **Error-Based:** Intentionally malformed queries cause the database to error, revealing information about its structure.
3.  **Blind SQLi:** The application doesn't return data or errors, but behaves differently (e.g., takes longer to load) based on whether the injected query is true or false.

### Step-by-Step: Manual Union SQL Injection
**Goal:** Extract the `admin` password.
**Scenario:** A search bar at `http://target.com/search?q=apple`.

1.  **Test for vulnerability:** Input `'`. If the page breaks or errors, it's likely vulnerable.
2.  **Determine column count:**
    *   `' ORDER BY 1 --` (No error)
    *   `' ORDER BY 2 --` (No error)
    *   `' ORDER BY 3 --` (Error!) -> Therefore, there are 2 columns.
3.  **Find the display point:**
    *   `' UNION SELECT 1, 2 --` -> See where "1" and "2" appear on the page.
4.  **Extract Data:**
    *   `' UNION SELECT username, password FROM users --` -> The page now displays user credentials instead of "1" and "2".

## 3.3 Cross-Site Scripting (XSS)
XSS allows attackers to execute malicious scripts in the victim's browser.

<!-- Placeholder: [Image: xss_flowchart.png] - The path of a malicious script from attacker to victim browser -->

### Types of XSS
1.  **Reflected XSS:** The script is part of the request (e.g., in the URL) and reflects off the server.
    *   *Attack Vector:* Phishing link.
2.  **Stored XSS:** The script is stored in the database (e.g., a forum post).
    *   *Attack Vector:* Anyone who views the page is attacked.
3.  **DOM-Based:** The vulnerability exists in the client-side JavaScript code.

### Step-by-Step: Intercepting Requests with Burp Suite
Burp Suite is the #1 tool for web hacking.

1.  **Setup:**
    *   Open Burp Suite Community Edition.
    *   Open the embedded browser (Proxy -> Open Browser).
2.  **Intercept:**
    *   Turn "Intercept is on" in the Proxy tab.
    *   Navigate to a website in the embedded browser.
    *   The request will "hang" in Burp. You can now see and edit it.
3.  **Modify:**
    *   Double-click any parameter (e.g., `price=10`).
    *   Change it to `price=0`.
    *   Click "Forward".
4.  **Result:** Check if you bought the item for free!

## 3.4 Command Injection
Remote Code Execution (RCE) via the shell.

*   **Vulnerability:** Input is passed directly to a system shell command (e.g., `system("ping " + input)`).
*   **Exploit:** Use separators to add your own command.
    *   `;` (Unix)
    *   `&&` (Success only)
    *   `||` (Failure only)
    *   Example: `127.0.0.1; cat /etc/passwd`
